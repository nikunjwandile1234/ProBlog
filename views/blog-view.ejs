<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('./partials/head') %>
  <title><%= blog.title %> - ProBlog</title>
</head>
<body>

<%- include('./partials/nav') %>

<div class="container mt-5 mb-5" style="max-width:900px">

  <h1 class="fw-bold mb-3"><%= blog.title %></h1>

  <div class="blog-meta mb-4">
    By <%= blog.author.name %> ‚Ä¢ <%= blog.readingTime %> min read ‚Ä¢ üëÅ <%= blog.views %>
  </div>

  <% if (user && (user._id === blog.author._id.toString() || user.role === "ADMIN")) { %>
    <form action="/blog/delete/<%= blog._id %>" method="POST">
      <button class="btn btn-danger btn-sm mb-3">Delete</button>
    </form>
  <% } %>

  <img src="<%= blog.coverImage %>" class="img-fluid rounded mb-4">

  <div class="fs-5" style="line-height:1.8;">
    <%- blog.content %>
  </div>

  <hr class="my-5">

  <h4>Comments (<%= comments.length %>)</h4>

  <% if (user) { %>
    <form action="/blog/comment/<%= blog._id %>" method="POST">
      <textarea name="content" class="form-control mb-2" required></textarea>
      <button class="btn btn-primary">Post</button>
    </form>
  <% } %>

  <% comments.forEach(c => { %>
    <div class="card p-3 mt-3">
      <b><%= c.author.name %></b>
      <div><%= c.content %></div>
    </div>
  <% }) %>

</div>

</body>
</html>


